ARM GAS  /tmp/cc0V0Oi5.s 			page 1


   1              		.cpu cortex-m7
   2              		.arch armv7e-m
   3              		.fpu fpv5-d16
   4              		.eabi_attribute 28, 1
   5              		.eabi_attribute 20, 1
   6              		.eabi_attribute 21, 1
   7              		.eabi_attribute 23, 3
   8              		.eabi_attribute 24, 1
   9              		.eabi_attribute 25, 1
  10              		.eabi_attribute 26, 1
  11              		.eabi_attribute 30, 1
  12              		.eabi_attribute 34, 1
  13              		.eabi_attribute 18, 4
  14              		.file	"loadcell.c"
  15              		.text
  16              	.Ltext0:
  17              		.cfi_sections	.debug_frame
  18              		.file 1 "../../../mod/loadcell/loadcell.c"
  19              		.section	.text.poll_loadcell_adc,"ax",%progbits
  20              		.align	1
  21              		.syntax unified
  22              		.thumb
  23              		.thumb_func
  25              	poll_loadcell_adc:
  26              	.LVL0:
  27              	.LFB334:
   1:../../../mod/loadcell/loadcell.c **** /*******************************************************************************
   2:../../../mod/loadcell/loadcell.c **** *
   3:../../../mod/loadcell/loadcell.c **** * FILE: 
   4:../../../mod/loadcell/loadcell.c **** * 		loadcell.c
   5:../../../mod/loadcell/loadcell.c **** *
   6:../../../mod/loadcell/loadcell.c **** * DESCRIPTION: 
   7:../../../mod/loadcell/loadcell.c **** * 		Contains API functions for reading data from the engine's load cell 
   8:../../../mod/loadcell/loadcell.c **** *
   9:../../../mod/loadcell/loadcell.c **** *******************************************************************************/
  10:../../../mod/loadcell/loadcell.c **** 
  11:../../../mod/loadcell/loadcell.c **** 
  12:../../../mod/loadcell/loadcell.c **** /*------------------------------------------------------------------------------
  13:../../../mod/loadcell/loadcell.c ****  Standard Includes                                                                     
  14:../../../mod/loadcell/loadcell.c **** ------------------------------------------------------------------------------*/
  15:../../../mod/loadcell/loadcell.c **** 
  16:../../../mod/loadcell/loadcell.c **** 
  17:../../../mod/loadcell/loadcell.c **** /*------------------------------------------------------------------------------
  18:../../../mod/loadcell/loadcell.c ****  Project Includes                                                                     
  19:../../../mod/loadcell/loadcell.c **** ------------------------------------------------------------------------------*/
  20:../../../mod/loadcell/loadcell.c **** #include "main.h"
  21:../../../mod/loadcell/loadcell.c **** #include "sdr_pin_defines_L0002.h"
  22:../../../mod/loadcell/loadcell.c **** #include "loadcell.h"
  23:../../../mod/loadcell/loadcell.c **** 
  24:../../../mod/loadcell/loadcell.c **** /*------------------------------------------------------------------------------
  25:../../../mod/loadcell/loadcell.c ****  Global Variables 
  26:../../../mod/loadcell/loadcell.c **** ------------------------------------------------------------------------------*/
  27:../../../mod/loadcell/loadcell.c **** 
  28:../../../mod/loadcell/loadcell.c **** 
  29:../../../mod/loadcell/loadcell.c **** /*------------------------------------------------------------------------------
  30:../../../mod/loadcell/loadcell.c ****  Internal function prototypes 
  31:../../../mod/loadcell/loadcell.c **** ------------------------------------------------------------------------------*/
ARM GAS  /tmp/cc0V0Oi5.s 			page 2


  32:../../../mod/loadcell/loadcell.c **** 
  33:../../../mod/loadcell/loadcell.c **** /* Sample the load cell ADC a specified number of times in polling mode */
  34:../../../mod/loadcell/loadcell.c **** static LOADCELL_STATUS poll_loadcell_adc 
  35:../../../mod/loadcell/loadcell.c **** 	(
  36:../../../mod/loadcell/loadcell.c ****     uint16_t    num_samples,
  37:../../../mod/loadcell/loadcell.c ****     uint32_t*   psample_buffer
  38:../../../mod/loadcell/loadcell.c ****     );
  39:../../../mod/loadcell/loadcell.c **** 
  40:../../../mod/loadcell/loadcell.c **** /*------------------------------------------------------------------------------
  41:../../../mod/loadcell/loadcell.c ****  API Functions 
  42:../../../mod/loadcell/loadcell.c **** ------------------------------------------------------------------------------*/
  43:../../../mod/loadcell/loadcell.c **** 
  44:../../../mod/loadcell/loadcell.c **** 
  45:../../../mod/loadcell/loadcell.c **** /*******************************************************************************
  46:../../../mod/loadcell/loadcell.c **** *                                                                              *
  47:../../../mod/loadcell/loadcell.c **** * PROCEDURE:                                                                   * 
  48:../../../mod/loadcell/loadcell.c **** * 		loadcell_get_reading                                                   *
  49:../../../mod/loadcell/loadcell.c **** *                                                                              *
  50:../../../mod/loadcell/loadcell.c **** * DESCRIPTION:                                                                 * 
  51:../../../mod/loadcell/loadcell.c **** *       Read the load cell force                                               *
  52:../../../mod/loadcell/loadcell.c **** *                                                                              *
  53:../../../mod/loadcell/loadcell.c **** *******************************************************************************/
  54:../../../mod/loadcell/loadcell.c **** LOADCELL_STATUS loadcell_get_reading 
  55:../../../mod/loadcell/loadcell.c **** 	(
  56:../../../mod/loadcell/loadcell.c ****     uint32_t* loadcell_reading_ptr /* Pointer to output data */
  57:../../../mod/loadcell/loadcell.c ****     )
  58:../../../mod/loadcell/loadcell.c **** {
  59:../../../mod/loadcell/loadcell.c **** /*------------------------------------------------------------------------------
  60:../../../mod/loadcell/loadcell.c ****  Local Variables  
  61:../../../mod/loadcell/loadcell.c **** ------------------------------------------------------------------------------*/
  62:../../../mod/loadcell/loadcell.c **** LOADCELL_STATUS loadcell_status; /* Return code from ADC operation */ 
  63:../../../mod/loadcell/loadcell.c **** 
  64:../../../mod/loadcell/loadcell.c **** 
  65:../../../mod/loadcell/loadcell.c **** /*------------------------------------------------------------------------------
  66:../../../mod/loadcell/loadcell.c ****  Initializations 
  67:../../../mod/loadcell/loadcell.c **** ------------------------------------------------------------------------------*/
  68:../../../mod/loadcell/loadcell.c **** loadcell_status  = LOADCELL_OK;
  69:../../../mod/loadcell/loadcell.c **** 
  70:../../../mod/loadcell/loadcell.c **** 
  71:../../../mod/loadcell/loadcell.c **** /*------------------------------------------------------------------------------
  72:../../../mod/loadcell/loadcell.c ****  Poll ADC once 
  73:../../../mod/loadcell/loadcell.c **** ------------------------------------------------------------------------------*/
  74:../../../mod/loadcell/loadcell.c **** loadcell_status = poll_loadcell_adc( 1, loadcell_reading_ptr );
  75:../../../mod/loadcell/loadcell.c **** if ( loadcell_status != LOADCELL_OK )
  76:../../../mod/loadcell/loadcell.c **** 	{
  77:../../../mod/loadcell/loadcell.c ****     return loadcell_status;
  78:../../../mod/loadcell/loadcell.c ****     }
  79:../../../mod/loadcell/loadcell.c **** return LOADCELL_OK;
  80:../../../mod/loadcell/loadcell.c **** 
  81:../../../mod/loadcell/loadcell.c **** } /* loadcell_get_reading */
  82:../../../mod/loadcell/loadcell.c **** 
  83:../../../mod/loadcell/loadcell.c **** 
  84:../../../mod/loadcell/loadcell.c **** /*------------------------------------------------------------------------------
  85:../../../mod/loadcell/loadcell.c ****  Internal procedures 
  86:../../../mod/loadcell/loadcell.c **** ------------------------------------------------------------------------------*/
  87:../../../mod/loadcell/loadcell.c **** 
  88:../../../mod/loadcell/loadcell.c **** 
ARM GAS  /tmp/cc0V0Oi5.s 			page 3


  89:../../../mod/loadcell/loadcell.c **** /*******************************************************************************
  90:../../../mod/loadcell/loadcell.c **** *                                                                              *
  91:../../../mod/loadcell/loadcell.c **** * PROCEDURE:                                                                   * 
  92:../../../mod/loadcell/loadcell.c **** * 		poll_loadcell_adc                                                      *
  93:../../../mod/loadcell/loadcell.c **** *                                                                              *
  94:../../../mod/loadcell/loadcell.c **** * DESCRIPTION:                                                                 * 
  95:../../../mod/loadcell/loadcell.c **** *       Sample the load cell ADC a specified number of times in polling mode   *
  96:../../../mod/loadcell/loadcell.c **** *                                                                              *
  97:../../../mod/loadcell/loadcell.c **** *******************************************************************************/
  98:../../../mod/loadcell/loadcell.c **** static LOADCELL_STATUS poll_loadcell_adc 
  99:../../../mod/loadcell/loadcell.c **** 	(
 100:../../../mod/loadcell/loadcell.c ****     uint16_t    num_samples,
 101:../../../mod/loadcell/loadcell.c ****     uint32_t*   psample_buffer
 102:../../../mod/loadcell/loadcell.c ****     )
 103:../../../mod/loadcell/loadcell.c **** {
  28              		.loc 1 103 1 view -0
  29              		.cfi_startproc
  30              		@ args = 0, pretend = 0, frame = 0
  31              		@ frame_needed = 0, uses_anonymous_args = 0
  32              		.loc 1 103 1 is_stmt 0 view .LVU1
  33 0000 70B5     		push	{r4, r5, r6, lr}
  34              	.LCFI0:
  35              		.cfi_def_cfa_offset 16
  36              		.cfi_offset 4, -16
  37              		.cfi_offset 5, -12
  38              		.cfi_offset 6, -8
  39              		.cfi_offset 14, -4
  40 0002 0546     		mov	r5, r0
  41 0004 0E46     		mov	r6, r1
 104:../../../mod/loadcell/loadcell.c **** /* Conversion status indicator */
 105:../../../mod/loadcell/loadcell.c **** HAL_StatusTypeDef adc_status;
  42              		.loc 1 105 1 is_stmt 1 view .LVU2
 106:../../../mod/loadcell/loadcell.c **** 
 107:../../../mod/loadcell/loadcell.c **** /* Start the ADC */
 108:../../../mod/loadcell/loadcell.c **** HAL_ADC_Start( &( LOADCELL_ADC ) );
  43              		.loc 1 108 1 view .LVU3
  44 0006 0F48     		ldr	r0, .L10
  45              	.LVL1:
  46              		.loc 1 108 1 is_stmt 0 view .LVU4
  47 0008 FFF7FEFF 		bl	HAL_ADC_Start
  48              	.LVL2:
 109:../../../mod/loadcell/loadcell.c **** 
 110:../../../mod/loadcell/loadcell.c **** /* Poll ADC */
 111:../../../mod/loadcell/loadcell.c **** for ( int i = 0; i < num_samples; ++i )
  49              		.loc 1 111 1 is_stmt 1 view .LVU5
  50              	.LBB2:
  51              		.loc 1 111 7 view .LVU6
  52              		.loc 1 111 11 is_stmt 0 view .LVU7
  53 000c 0024     		movs	r4, #0
  54              		.loc 1 111 1 view .LVU8
  55 000e 05E0     		b	.L2
  56              	.LVL3:
  57              	.L9:
 112:../../../mod/loadcell/loadcell.c **** 	{
 113:../../../mod/loadcell/loadcell.c **** 	/* Wait for end of conversion */
 114:../../../mod/loadcell/loadcell.c ****     adc_status = HAL_ADC_PollForConversion( &( LOADCELL_ADC ), 
 115:../../../mod/loadcell/loadcell.c **** 	                                        LOADCELL_ADC_HAL_TIMEOUT );
ARM GAS  /tmp/cc0V0Oi5.s 			page 4


 116:../../../mod/loadcell/loadcell.c ****     if      ( adc_status == HAL_TIMEOUT )
 117:../../../mod/loadcell/loadcell.c **** 		{
 118:../../../mod/loadcell/loadcell.c ****         return LOADCELL_ADC_TIMEOUT;
 119:../../../mod/loadcell/loadcell.c ****         }
 120:../../../mod/loadcell/loadcell.c **** 	else if ( adc_status != HAL_OK      )
 121:../../../mod/loadcell/loadcell.c **** 		{
 122:../../../mod/loadcell/loadcell.c ****         return LOADCELL_ADC_POLL_ERROR;
 123:../../../mod/loadcell/loadcell.c ****         }
 124:../../../mod/loadcell/loadcell.c **** 	else /* No error */
 125:../../../mod/loadcell/loadcell.c **** 		{
 126:../../../mod/loadcell/loadcell.c **** 		/* Read the ADC value */
 127:../../../mod/loadcell/loadcell.c **** 		*(psample_buffer + i) = HAL_ADC_GetValue( &( LOADCELL_ADC ) ); 
  58              		.loc 1 127 3 is_stmt 1 discriminator 2 view .LVU9
  59              		.loc 1 127 27 is_stmt 0 discriminator 2 view .LVU10
  60 0010 0C48     		ldr	r0, .L10
  61              	.LVL4:
  62              		.loc 1 127 27 discriminator 2 view .LVU11
  63 0012 FFF7FEFF 		bl	HAL_ADC_GetValue
  64              	.LVL5:
  65              		.loc 1 127 25 discriminator 2 view .LVU12
  66 0016 46F82400 		str	r0, [r6, r4, lsl #2]
 111:../../../mod/loadcell/loadcell.c **** 	{
  67              		.loc 1 111 35 is_stmt 1 discriminator 2 view .LVU13
  68 001a 0134     		adds	r4, r4, #1
  69              	.LVL6:
  70              	.L2:
 111:../../../mod/loadcell/loadcell.c **** 	{
  71              		.loc 1 111 20 discriminator 1 view .LVU14
  72 001c A542     		cmp	r5, r4
  73 001e 09DD     		ble	.L8
 114:../../../mod/loadcell/loadcell.c **** 	                                        LOADCELL_ADC_HAL_TIMEOUT );
  74              		.loc 1 114 5 view .LVU15
 114:../../../mod/loadcell/loadcell.c **** 	                                        LOADCELL_ADC_HAL_TIMEOUT );
  75              		.loc 1 114 18 is_stmt 0 view .LVU16
  76 0020 6421     		movs	r1, #100
  77 0022 0848     		ldr	r0, .L10
  78 0024 FFF7FEFF 		bl	HAL_ADC_PollForConversion
  79              	.LVL7:
 116:../../../mod/loadcell/loadcell.c **** 		{
  80              		.loc 1 116 5 is_stmt 1 view .LVU17
 116:../../../mod/loadcell/loadcell.c **** 		{
  81              		.loc 1 116 13 is_stmt 0 view .LVU18
  82 0028 0328     		cmp	r0, #3
  83 002a 08D0     		beq	.L5
 120:../../../mod/loadcell/loadcell.c **** 		{
  84              		.loc 1 120 7 is_stmt 1 view .LVU19
 120:../../../mod/loadcell/loadcell.c **** 		{
  85              		.loc 1 120 10 is_stmt 0 view .LVU20
  86 002c 0028     		cmp	r0, #0
  87 002e EFD0     		beq	.L9
 122:../../../mod/loadcell/loadcell.c ****         }
  88              		.loc 1 122 16 view .LVU21
  89 0030 0220     		movs	r0, #2
  90              	.LVL8:
 122:../../../mod/loadcell/loadcell.c ****         }
  91              		.loc 1 122 16 view .LVU22
  92 0032 03E0     		b	.L3
ARM GAS  /tmp/cc0V0Oi5.s 			page 5


  93              	.LVL9:
  94              	.L8:
 122:../../../mod/loadcell/loadcell.c ****         }
  95              		.loc 1 122 16 view .LVU23
  96              	.LBE2:
 128:../../../mod/loadcell/loadcell.c ****         }
 129:../../../mod/loadcell/loadcell.c ****     }
 130:../../../mod/loadcell/loadcell.c **** 
 131:../../../mod/loadcell/loadcell.c **** /* Stop the ADC */
 132:../../../mod/loadcell/loadcell.c **** HAL_ADC_Stop( &( LOADCELL_ADC ) );
  97              		.loc 1 132 1 is_stmt 1 view .LVU24
  98 0034 0348     		ldr	r0, .L10
  99 0036 FFF7FEFF 		bl	HAL_ADC_Stop
 100              	.LVL10:
 133:../../../mod/loadcell/loadcell.c **** 
 134:../../../mod/loadcell/loadcell.c **** /* Conversion successful */
 135:../../../mod/loadcell/loadcell.c **** return LOADCELL_OK;
 101              		.loc 1 135 1 view .LVU25
 102              		.loc 1 135 8 is_stmt 0 view .LVU26
 103 003a 0020     		movs	r0, #0
 104              	.L3:
 136:../../../mod/loadcell/loadcell.c **** 
 137:../../../mod/loadcell/loadcell.c **** } /* poll_load_cell_adc */
 105              		.loc 1 137 1 view .LVU27
 106 003c 70BD     		pop	{r4, r5, r6, pc}
 107              	.LVL11:
 108              	.L5:
 109              	.LBB3:
 118:../../../mod/loadcell/loadcell.c ****         }
 110              		.loc 1 118 16 view .LVU28
 111 003e 0120     		movs	r0, #1
 112              	.LVL12:
 118:../../../mod/loadcell/loadcell.c ****         }
 113              		.loc 1 118 16 view .LVU29
 114 0040 FCE7     		b	.L3
 115              	.L11:
 116 0042 00BF     		.align	2
 117              	.L10:
 118 0044 00000000 		.word	hadc2
 119              	.LBE3:
 120              		.cfi_endproc
 121              	.LFE334:
 123              		.section	.text.loadcell_get_reading,"ax",%progbits
 124              		.align	1
 125              		.global	loadcell_get_reading
 126              		.syntax unified
 127              		.thumb
 128              		.thumb_func
 130              	loadcell_get_reading:
 131              	.LVL13:
 132              	.LFB333:
  58:../../../mod/loadcell/loadcell.c **** /*------------------------------------------------------------------------------
 133              		.loc 1 58 1 is_stmt 1 view -0
 134              		.cfi_startproc
 135              		@ args = 0, pretend = 0, frame = 0
 136              		@ frame_needed = 0, uses_anonymous_args = 0
  58:../../../mod/loadcell/loadcell.c **** /*------------------------------------------------------------------------------
ARM GAS  /tmp/cc0V0Oi5.s 			page 6


 137              		.loc 1 58 1 is_stmt 0 view .LVU31
 138 0000 08B5     		push	{r3, lr}
 139              	.LCFI1:
 140              		.cfi_def_cfa_offset 8
 141              		.cfi_offset 3, -8
 142              		.cfi_offset 14, -4
 143 0002 0146     		mov	r1, r0
  62:../../../mod/loadcell/loadcell.c **** 
 144              		.loc 1 62 1 is_stmt 1 view .LVU32
  68:../../../mod/loadcell/loadcell.c **** 
 145              		.loc 1 68 1 view .LVU33
 146              	.LVL14:
  74:../../../mod/loadcell/loadcell.c **** if ( loadcell_status != LOADCELL_OK )
 147              		.loc 1 74 1 view .LVU34
  74:../../../mod/loadcell/loadcell.c **** if ( loadcell_status != LOADCELL_OK )
 148              		.loc 1 74 19 is_stmt 0 view .LVU35
 149 0004 0120     		movs	r0, #1
 150              	.LVL15:
  74:../../../mod/loadcell/loadcell.c **** if ( loadcell_status != LOADCELL_OK )
 151              		.loc 1 74 19 view .LVU36
 152 0006 FFF7FEFF 		bl	poll_loadcell_adc
 153              	.LVL16:
  75:../../../mod/loadcell/loadcell.c **** 	{
 154              		.loc 1 75 1 is_stmt 1 view .LVU37
  81:../../../mod/loadcell/loadcell.c **** 
 155              		.loc 1 81 1 is_stmt 0 view .LVU38
 156 000a 08BD     		pop	{r3, pc}
 157              		.cfi_endproc
 158              	.LFE333:
 160              		.text
 161              	.Letext0:
 162              		.file 2 "/usr/lib/gcc/arm-none-eabi/12.2.1/include/stdint.h"
 163              		.file 3 "../../../lib/Drivers/CMSIS/Device/ST/STM32H7xx/Include/stm32h750xx.h"
 164              		.file 4 "../../../lib/Drivers/CMSIS/Device/ST/STM32H7xx/Include/stm32h7xx.h"
 165              		.file 5 "../../../lib/Drivers/STM32H7xx_HAL_Driver/Inc/stm32h7xx_hal_def.h"
 166              		.file 6 "../../../lib/Drivers/STM32H7xx_HAL_Driver/Inc/stm32h7xx_hal_dma.h"
 167              		.file 7 "../../../lib/Drivers/STM32H7xx_HAL_Driver/Inc/stm32h7xx_hal_adc.h"
 168              		.file 8 "../../../mod/loadcell/loadcell.h"
 169              		.file 9 "../../../lib/sdr_pin_defines_L0002.h"
ARM GAS  /tmp/cc0V0Oi5.s 			page 7


DEFINED SYMBOLS
                            *ABS*:0000000000000000 loadcell.c
     /tmp/cc0V0Oi5.s:20     .text.poll_loadcell_adc:0000000000000000 $t
     /tmp/cc0V0Oi5.s:25     .text.poll_loadcell_adc:0000000000000000 poll_loadcell_adc
     /tmp/cc0V0Oi5.s:118    .text.poll_loadcell_adc:0000000000000044 $d
     /tmp/cc0V0Oi5.s:124    .text.loadcell_get_reading:0000000000000000 $t
     /tmp/cc0V0Oi5.s:130    .text.loadcell_get_reading:0000000000000000 loadcell_get_reading

UNDEFINED SYMBOLS
HAL_ADC_Start
HAL_ADC_GetValue
HAL_ADC_PollForConversion
HAL_ADC_Stop
hadc2
